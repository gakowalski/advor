To build AdvOR.dll install masm32 from http://www.masm32.com then execute DLL\a.bat


## Instructions for building AdvOR with MinGW (http://www.mingw.org/)
##

Stage One:  Download and Install MinGW.
---------------------------------------

Download mingw:
http://prdownloads.sf.net/mingw/MinGW-5.1.4.exe?download

Download msys:
http://prdownloads.sf.net/mingw/MSYS-1.0.10.exe?download

Download the mingw developer tool kit:
http://prdownloads.sf.net/mingw/msysDTK-1.0.1.exe?download

Download the mingw autoconf-2.59 update:
http://prdownloads.sf.net/mingw/msys-autoconf-2.59.tar.bz2?download

Install mingw, msys and mingw-dtk.  Extract msys-autoconf-2.59.tar.bz2 into
your mingw install location.  For example, if you installed mingw into
/c/mingw/1.0/ you want to extract msys-autoconf-2.59.tar.bz2 into this
directory.

Create a directory called "AdvOR".

Download masm32 from http://masm32.com/masmdl.htm

Install masm32.




Stage Two:  Download, extract, compile zlib
---------------------------------------------

Download zlib source:
http://zlib.net/zlib-1.2.8.tar.gz

Extract zlib:
Copy the zlib tarball into the "AdvOR" directory
Type "cd AdvOR/"
Type "tar zxf zlib-1.2.8.tar.gz"

CHOICE:

Make zlib.a:
Type "cd AdvOR/zlib-1.2.8/"
Type "./configure"
Type "make -f win32/Makefile.gcc"
Assuming you have MingGW installed in c:/ :
Type cp -iv zlib1.dll c:/mingw/bin
Type cp -iv zconf.h zlib.h c:/mingw/include
Type cp -iv libz.a c:/mingw/lib/libzlib.a

Done.



Stage Three:  Download, extract, compile openssl
----------------------------------------------

Download openssl:
http://www.openssl.org/source/openssl-1.0.1g.tar.gz

Extract openssl:
Copy the openssl tarball into the "AdvOR" directory.
Type "cd AdvOR/"
Type "tar zxf openssl-1.0.1g.tar.gz"

Edit MinGW/include/wincrypt.h and add the following lines:
	typedef struct _PUBKEY {
	DWORD magic ;
	DWORD bitlen ;
	} DSSPUBKEY ;

	#define CERT_STORE_PROV_SYSTEM_A ((LPCSTR) 9)
	#define CERT_STORE_READONLY_FLAG 0x00008000
	BOOL WINAPI CryptEnumProvidersA( DWORD, DWORD *, DWORD, DWORD *, LPSTR, DWORD *) ;


Make openssl libraries:
Type "cd AdvOR/openssl-1.0.1g/"
Type "./Configure -no-idea -no-rc5 -no-mdc2 mingw"
Edit Makefile and remove the "test:" and "tests:" sections.
Type "rm -rf ./test"
Type "make depend"
# The next steps can take up to 30 minutes to complete.
Type "make"
Type "make install"


Stage Four: Download, extract, and compile libevent-2.0.21
------------------------------------------------------

Download the libevent 2.0.21 release:
https://github.com/downloads/libevent/libevent/libevent-2.0.21-stable.tar.gz

Copy the libevent tarball into the "AdvOR" directory.
Type "cd AdvOR"

Extract libevent.

Type "./configure --enable-static --disable-shared"
Edit Makefile and change "SUBDIRS = . include sample test" to "SUBDIRS = . include".
Type "make"
Type "make install"


Stage Five: Download, extract, and compile libntlm-1.4
------------------------------------------------------

Download the libntlm 1.4 release:
http://www.nongnu.org/libntlm/releases/

Copy the libevent tarball into the "AdvOR" directory.
Type "cd AdvOR"

Extract libntlm.

Type "./configure --enable-static --disable-shared"
Type "make"
Type "make install"


Stage Six:  Build AdvOR
----------------------

Download the current AdvOR release from https://sourceforge.net/projects/AdvTor/ .
Extract AdvOR-src.zip into the "AdvOR" directory.

cd AdvOR
Type "./configure --disable-dependency-tracking"
Type "make"

You now have a AdvOR.exe in src/or/.

